<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="测试一下描述"><title>全面体验Retrofit2.0 | erwa'blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">全面体验Retrofit2.0</h1><a id="logo" href="/.">erwa'blog</a><p class="description">非常高兴你能来到这里！</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">全面体验Retrofit2.0</h1><div class="post-meta">Jan 11, 2017<span> | </span><span class="category"><a href="/categories/tech/">tech</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2017/01/11/retrofit2-experience/" href="/2017/01/11/retrofit2-experience/#comments" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#放在前边"><span class="toc-number">1.</span> <span class="toc-text">放在前边</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Retrofit2-0"><span class="toc-number">2.</span> <span class="toc-text">Retrofit2.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gradle配置"><span class="toc-number">3.</span> <span class="toc-text">Gradle配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码实践与记录"><span class="toc-number">4.</span> <span class="toc-text">代码实践与记录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#同步和异步请求"><span class="toc-number">4.1.</span> <span class="toc-text">同步和异步请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#API的注解使用"><span class="toc-number">4.2.</span> <span class="toc-text">API的注解使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定返回类型Map、List"><span class="toc-number">4.3.</span> <span class="toc-text">指定返回类型Map、List</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义Converter、CallAdapter"><span class="toc-number">4.4.</span> <span class="toc-text">自定义Converter、CallAdapter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#自定义StringConverter"><span class="toc-number">4.4.1.</span> <span class="toc-text">自定义StringConverter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#自定义CustomCallAdapter"><span class="toc-number">4.4.2.</span> <span class="toc-text">自定义CustomCallAdapter</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#放在后边"><span class="toc-number">5.</span> <span class="toc-text">放在后边</span></a></li></ol></div></div><div class="post-content"><h3 id="放在前边"><a href="#放在前边" class="headerlink" title="放在前边"></a>放在前边</h3><blockquote>
<p>注：本篇是对Retrofit2.0的全面体验，并未涉及RxJava、OkHttp。</p>
</blockquote>
<p><a href="https://github.com/drawf/demo.retrofit" target="_blank" rel="external">demo.retrofit传送门</a></p>
<p><img src="http://7sbl4z.com1.z0.glb.clouddn.com/demo.retrofit/blog/master/images/screenshot_1.png?imageMogr2/thumbnail/250x" alt=""></p>
<h3 id="Retrofit2-0"><a href="#Retrofit2-0" class="headerlink" title="Retrofit2.0"></a>Retrofit2.0</h3><p>Slogan:A type-safe HTTP client for Android and Java.</p>
<p>Retrofit is a type-safe REST client for Android built by Square. The library provides a powerful framework for authenticating and interacting with APIs and sending network requests with OkHttp.</p>
<p>官方标语：一个用于Android和Java平台的类型安全的网络框架。</p>
<p>Retrofit是一个Square开发的类型安全的REST安卓客户端请求库。这个库为网络认证、API请求以及用OkHttp发送网络请求提供了强大的框架 。</p>
<h3 id="Gradle配置"><a href="#Gradle配置" class="headerlink" title="Gradle配置"></a>Gradle配置</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">compile</span> <span class="string">'com.google.guava:guava:20.0'</span></div><div class="line"><span class="keyword">compile</span> <span class="string">'com.squareup.retrofit2:retrofit:2.1.0'</span></div><div class="line"><span class="keyword">compile</span> <span class="string">'com.squareup.retrofit2:converter-gson:2.1.0'</span></div></pre></td></tr></table></figure>
<p>Google Guava库是一个非常优秀的包含很多Java工具类集的库，广泛使用在Google公司内部，因此它可以被使用到几乎所有的Java项目中。更多使用姿势，大家自行google，未来我也会整理出关于Guava的博客。</p>
<h3 id="代码实践与记录"><a href="#代码实践与记录" class="headerlink" title="代码实践与记录"></a>代码实践与记录</h3><h4 id="同步和异步请求"><a href="#同步和异步请求" class="headerlink" title="同步和异步请求"></a>同步和异步请求</h4><blockquote>
<p>一个完整的请求包含以下几个步骤</p>
</blockquote>
<ol>
<li><p>构建Retrofit对象</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Retrofit retrofit = <span class="keyword">new</span> Retrofit.Builder()</div><div class="line">         <span class="comment">//用于请求的HTTP client，设置OkHttpClient，有默认值。该方法是引用传递，对client的修改会影响后续请求。</span></div><div class="line">         .client(client)</div><div class="line">         .baseUrl(MovieService.BASE_URL)<span class="comment">//设置baseUrl</span></div><div class="line">         .addConverterFactory(GsonConverterFactory.create())</div><div class="line">         <span class="comment">//是否在调用create(Class)时检测接口定义是否正确，而不是在调用方法才检测，在开发、测试时使用。</span></div><div class="line">         .validateEagerly(BuildConfig.DEBUG)</div><div class="line">         .build();</div></pre></td></tr></table></figure>
</li>
<li><p>以interface的方式定义API</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MovieService</span> </span>&#123;</div><div class="line"></div><div class="line">    String BASE_URL = <span class="string">"https://api.douban.com/v2/movie/"</span>;</div><div class="line"></div><div class="line">    <span class="meta">@GET</span>(<span class="string">"top250"</span>)</div><div class="line">    <span class="function">Call&lt;JsonObject&gt; <span class="title">getTopMovie</span><span class="params">(@Query(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 这里需要注意的是<code>BASE_URL</code>与<code>注解中的url</code>组合规则：</p>
 <figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">BaseUrl ＋ 注解中的url ＝ 最终结果</div><div class="line"></div><div class="line">http<span class="variable">s:</span>//api.douban.<span class="keyword">com</span>/v2/movie/ + top250 = http<span class="variable">s:</span>//api.douban.<span class="keyword">com</span>/v2/movie/top250</div><div class="line">http<span class="variable">s:</span>//api.douban.<span class="keyword">com</span>/v2/movie + top250 = http<span class="variable">s:</span>//api.douban.<span class="keyword">com</span>/v2/top250</div><div class="line">http<span class="variable">s:</span>//api.douban.<span class="keyword">com</span>/v2/movie/ + /top250 = http<span class="variable">s:</span>//api.douban.<span class="keyword">com</span>/top250</div><div class="line">http<span class="variable">s:</span>//api.douban.<span class="keyword">com</span>/v2/movie/ + http<span class="variable">s:</span>//github.<span class="keyword">com</span>/drawf = http<span class="variable">s:</span>//github.<span class="keyword">com</span>/drawf</div></pre></td></tr></table></figure>
</li>
<li><p>得到Call对象即可进行请求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">mMovieService = retrofit.create(MovieService.class);<span class="comment">//创建定义API接口的实现</span></div><div class="line">mCall = mMovieService.getTopMovie(<span class="number">0</span>, <span class="number">2</span>);<span class="comment">//调用API得到Call对象</span></div><div class="line"></div><div class="line">mCall.cancel();<span class="comment">//取消请求，mCall执行方法只能调用一次,否则会抛IllegalStateException</span></div><div class="line">mCall.request();<span class="comment">//得到Request对象</span></div><div class="line">mCall.clone();<span class="comment">//克隆一个实例</span></div><div class="line">mCall.isCanceled();<span class="comment">//是否取消了请求</span></div><div class="line">mCall.isExecuted();<span class="comment">//是否已执行或已入队列</span></div><div class="line"></div><div class="line">mCall.execute();<span class="comment">//同步请求</span></div><div class="line">mCall.enqueue(Callback&lt;T&gt; callback);<span class="comment">//异步请求</span></div><div class="line"></div><div class="line"><span class="comment">//请求返回的Response对象</span></div><div class="line">response.code();<span class="comment">//HTTP status code.</span></div><div class="line">response.isSuccessful();<span class="comment">//Returns true if code() is in the range [200..300).</span></div><div class="line">response.message();<span class="comment">//HTTP status message or null if unknown.</span></div><div class="line">response.headers();<span class="comment">//HTTP headers.</span></div><div class="line"></div><div class="line">response.raw();<span class="comment">//The raw response from the HTTP client. 打印发现该方法返回数据不全</span></div><div class="line">response.body();<span class="comment">//The deserialized response body of a successful response.它就是你想要的数据</span></div><div class="line">response.errorBody();<span class="comment">//The raw response body of an unsuccessful response.</span></div></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="API的注解使用"><a href="#API的注解使用" class="headerlink" title="API的注解使用"></a>API的注解使用</h4><p>Retrofit注解共23个，分三类介绍</p>
<ol>
<li><p>HTTP请求方法</p>
 <table><thead><tr class="thead-first-child"><th align="center"> 注解 </th><th align="center"> 说明 </th></tr></thead><tbody><tr class="tbody-first-child"><td align="center"> GET、POST、PUT、DELETE、<br>PATCH、HEAD、OPTIONS </td><td align="center"> 1，分别对应HTTP请求方法<br> 2，接受一个字符串作为注解中的url，默认为&quot;&quot;</td></tr><tr class="tbody-even-child"><td align="center"> HTTP </td><td align="center"> 可以替换上述7个方法，或者其它扩展方法 </td></tr></tbody></table>

 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*可以替代其它请求方法*/</span></div><div class="line"><span class="comment">/*String method(); 请求方法，必须大写*/</span></div><div class="line"><span class="comment">/*String path() default ""; 请求路径*/</span></div><div class="line"><span class="comment">/*boolean hasBody() default false; 是否有请求体*/</span></div><div class="line"><span class="meta">@HTTP</span>(method = <span class="string">"GET"</span>, path = <span class="string">"top250"</span>, hasBody = <span class="keyword">false</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testHttp</span><span class="params">(@Query(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>参数类</p>
 <table><thead><tr class="thead-first-child"><th align="center"> 注解 </th><th align="center"> 说明 </th></tr></thead><tbody><tr class="tbody-first-child"><td align="center"> Query、QueryMap </td><td align="center"> 用于GET的请求参数 </td></tr><tr class="tbody-even-child"><td align="center"> Url </td><td align="center"> 用于全路径复写BaseUrl </td></tr><tr class="tbody-odd-child"><td align="center"> Path </td><td align="center"> 用于替换和动态更新URL的占位符 </td></tr><tr class="tbody-even-child"><td align="center"> Header、HeaderMap、Headers </td><td align="center"> 用于添加请求头 </td></tr><tr class="tbody-odd-child"><td align="center"> Body </td><td align="center"> 用于POST、PUT、PATCH请求体 </td></tr><tr class="tbody-even-child"><td align="center"> Field、FieldMap </td><td align="center"> 用于form表单形式的键值对参数 </td></tr><tr class="tbody-odd-child"><td align="center"> Part、PartMap </td><td align="center"> 用于POST文件上传 </td></tr></tbody></table>

 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*@Query，@QueryMap 查询参数，用于GET查询，两者都可以约定是否需要encode，默认false*/</span></div><div class="line"><span class="comment">/*@Query(value = "start", encoded = true) int start*/</span></div><div class="line"><span class="meta">@GET</span>(<span class="string">"top250"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testQueryMap</span><span class="params">(@QueryMap(encoded = <span class="keyword">true</span>)</span> Map&lt;String, Object&gt; params)</span>;</div><div class="line"></div><div class="line"><span class="comment">/*使用全路径复写baseUrl，用于非统一baseUrl的场景*/</span></div><div class="line"><span class="meta">@GET</span></div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testUrl</span><span class="params">(@Url String url)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">/*URL占位符，用于替换和动态更新，相应的参数必须使用相同的字符串被@Path进行注释*/</span></div><div class="line"><span class="meta">@GET</span>(<span class="string">"&#123;type&#125;"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testPath</span><span class="params">(@Path(<span class="string">"type"</span>)</span> String type, @<span class="title">Query</span><span class="params">(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div><div class="line"></div><div class="line"><span class="comment">/*@Header，@HeaderMap，@Headers 不能被互相覆盖*/</span></div><div class="line"><span class="meta">@Headers</span>(&#123;</div><div class="line">        <span class="string">"token:test override"</span>,</div><div class="line">        <span class="string">"User-Agent: Wanzi-Retrofit-Sample-App"</span></div><div class="line">&#125;)</div><div class="line"><span class="meta">@GET</span>(<span class="string">"top250"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testHeader</span><span class="params">(@Header(<span class="string">"token"</span>)</span> String token, @<span class="title">Query</span><span class="params">(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div><div class="line"></div><div class="line"><span class="comment">/*用于POST、PUT、PATCH请求体，将实例对象根据GsonConverterFactory定义的转化方式转换为对应的json字符串参数*/</span></div><div class="line"><span class="comment">/*@Body与@FormUrlEncoded、@Field不能同时使用*/</span></div><div class="line"><span class="meta">@PUT</span>(<span class="string">"update"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testBody</span><span class="params">(@Body User user)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">/*@Field，@FieldMap 为form表单形式的键值对*/</span></div><div class="line"><span class="comment">/*需要添加@FormUrlEncoded表示表单提交 Content-Type:application/x-www-form-urlencoded*/</span></div><div class="line"><span class="meta">@FormUrlEncoded</span></div><div class="line"><span class="meta">@POST</span>(<span class="string">"update"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testField</span><span class="params">(@Field(<span class="string">"name"</span>)</span> String name, @<span class="title">Field</span><span class="params">(<span class="string">"age"</span>)</span> <span class="keyword">int</span> age)</span>;</div><div class="line"></div><div class="line"><span class="comment">/*@Part，@PartMap 用于POST文件上传*/</span></div><div class="line"><span class="comment">/*其中@Part MultipartBody.Part代表文件，@Part("key") RequestBody或其它类型代表参数*/</span></div><div class="line"><span class="comment">/*需要添加@Multipart表示支持文件上传的表单，Content-Type: multipart/form-data*/</span></div><div class="line"><span class="meta">@Multipart</span></div><div class="line"><span class="meta">@POST</span>(<span class="string">"upload"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testPart</span><span class="params">(@Part(<span class="string">"desc"</span>)</span> String desc, @Part MultipartBody.Part file)</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>标记类</p>
 <table><thead><tr class="thead-first-child"><th align="center"> 注解 </th><th align="center"> 说明 </th></tr></thead><tbody><tr class="tbody-first-child"><td align="center"> FormUrlEncoded </td><td align="center"> 表示请求体是一个Form表单 </td></tr><tr class="tbody-even-child"><td align="center"> Multipart </td><td align="center"> 1，意思为多部分，表示请求体是一个支持文件上传的Form表单<br> 2，建议去深入了解HTTP协议</td></tr><tr class="tbody-odd-child"><td align="center"> Streaming </td><td align="center"> 表示响应体数据以流的形式返回 </td></tr></tbody></table>

 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*@Field，@FieldMap 为form表单形式的键值对*/</span></div><div class="line"><span class="comment">/*需要添加@FormUrlEncoded表示表单提交 Content-Type:application/x-www-form-urlencoded*/</span></div><div class="line"><span class="meta">@FormUrlEncoded</span></div><div class="line"><span class="meta">@POST</span>(<span class="string">"update"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testField</span><span class="params">(@Field(<span class="string">"name"</span>)</span> String name, @<span class="title">Field</span><span class="params">(<span class="string">"age"</span>)</span> <span class="keyword">int</span> age)</span>;</div><div class="line"></div><div class="line"><span class="comment">/*@Part，@PartMap 用于POST文件上传*/</span></div><div class="line"><span class="comment">/*其中@Part MultipartBody.Part代表文件，@Part("key") RequestBody或其它类型代表参数*/</span></div><div class="line"><span class="comment">/*需要添加@Multipart表示支持文件上传的表单，Content-Type: multipart/form-data*/</span></div><div class="line"><span class="meta">@Multipart</span></div><div class="line"><span class="meta">@POST</span>(<span class="string">"upload"</span>)</div><div class="line"><span class="function">Call&lt;JsonObject&gt; <span class="title">testPart</span><span class="params">(@Part(<span class="string">"desc"</span>)</span> String desc, @Part MultipartBody.Part file)</span>;</div><div class="line"></div><div class="line"><span class="comment">/*用于下载文件*/</span></div><div class="line"><span class="comment">/*表示响应体数据以流的形式返回，如果没有使用该注解，默认会把数据全部载入内存，之后是从内存中读取数据，所以数据很大时，适合用该标记*/</span></div><div class="line"><span class="meta">@Streaming</span></div><div class="line"><span class="meta">@GET</span></div><div class="line"><span class="function">Call&lt;ResponseBody&gt; <span class="title">testStreaming</span><span class="params">(@Url String url)</span></span>;</div></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="指定返回类型Map、List"><a href="#指定返回类型Map、List" class="headerlink" title="指定返回类型Map、List"></a>指定返回类型Map、List</h4><p>GsonConverterFactory支持返回类型Map、List，实验发现不支持String。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@GET</span>(<span class="string">"top250"</span>)</div><div class="line">Call&lt;Map&lt;String, Object&gt;&gt; testMap(<span class="meta">@Query</span>(<span class="string">"start"</span>) <span class="keyword">int</span> start, <span class="meta">@Query</span>(<span class="string">"count"</span>) <span class="keyword">int</span> count);</div><div class="line"></div><div class="line"><span class="meta">@GET</span></div><div class="line">Call&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt; testList(<span class="meta">@Url</span> String url, <span class="meta">@Query</span>(<span class="string">"start"</span>) <span class="keyword">int</span> start, <span class="meta">@Query</span>(<span class="string">"count"</span>) <span class="keyword">int</span> count);</div></pre></td></tr></table></figure>
<h4 id="自定义Converter、CallAdapter"><a href="#自定义Converter、CallAdapter" class="headerlink" title="自定义Converter、CallAdapter"></a>自定义Converter、CallAdapter</h4><h5 id="自定义StringConverter"><a href="#自定义StringConverter" class="headerlink" title="自定义StringConverter"></a>自定义StringConverter</h5><p><code>Converter</code>的目的是将<code>Call&lt;ResponseBody&gt;</code>转换为<code>Call&lt;JsonObject&gt;</code>、<code>Call&lt;Map&lt;String, Object&gt;&gt;</code>、<code>Call&lt;String&gt;</code>等等。</p>
<ol>
<li><p><code>new Retrofit.Builder().addConverterFactory(Converter.Factory factory)</code>，该方法接收一个Factory，该工厂向Retrofit提供相应的Converter，<br>所以第一步写一个工厂类。具体写的时候多参考<code>GsonConverterFactory</code>源码，有助于理解。</p>
<p> 抽象类<code>Converter.Factory</code>中有三个可以覆写的方法：</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*创建一个将ResponseBody响应体转换为自定义类型的Converter，不能处理时应返回null*/</span></div><div class="line"><span class="keyword">public</span> Converter&lt;ResponseBody, ?&gt; responseBodyConverter(Type type, Annotation[] annotations,</div><div class="line">    Retrofit retrofit) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*创建一个将自定义类型转换为RequestBody请求体的Converter，不能处理时应返回null*/</span></div><div class="line"><span class="keyword">public</span> Converter&lt;?, RequestBody&gt; requestBodyConverter(Type type,</div><div class="line">    Annotation[] parameterAnnotations, Annotation[] methodAnnotations, Retrofit retrofit) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*这里用于对Field、FieldMap、Header、HeaderMap、Path、Query、QueryMap注解的处理，Retrofit默认调用的toString方法*/</span></div><div class="line"><span class="keyword">public</span> Converter&lt;?, String&gt; stringConverter(Type type, Annotation[] annotations,</div><div class="line">    Retrofit retrofit) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 因为我们只要将请求结果<code>ResponseBody</code>转换为<code>String</code>，所以只覆写<code>responseBodyConverter</code>。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringConverterFactory</span> <span class="keyword">extends</span> <span class="title">Converter</span>.<span class="title">Factory</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> StringConverterFactory <span class="title">create</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringConverterFactory();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> Converter&lt;ResponseBody, ?&gt; responseBodyConverter(Type type, Annotation[] annotations, Retrofit retrofit) &#123;</div><div class="line">        <span class="keyword">if</span> (type == String.class) &#123;<span class="comment">//判断是否是要处理的类型</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> StringResponseBodyConverter();<span class="comment">//这里创建具体的Converter</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;<span class="comment">//不能处理就返回null</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>public interface Converter&lt;F, T&gt;</code>，该泛型接口提供了一个接口<code>T convert(F value) throws IOException;</code>实现这个接口，可以将F泛型转化为T泛型。</p>
<p> 我们想从<code>Call&lt;ResponseBody&gt;</code>转换为<code>Call&lt;String&gt;</code>，所以<code>F</code>、<code>T</code>分别对应<code>ResponseBody</code>、<code>String</code>。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringResponseBodyConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">ResponseBody</span>, <span class="title">String</span>&gt; </span>&#123;</div><div class="line"></div><div class="line"><span class="comment">//    T convert(F value) throws IOException;</span></div><div class="line"><span class="comment">//    实现从 F(from) 到 T(to) 的转换</span></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convert</span><span class="params">(ResponseBody value)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">return</span> value.string();</div><div class="line">        &#125; <span class="keyword">finally</span> &#123;</div><div class="line">            value.close();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>至此就可以愉快的使用自定义的<code>Converter</code>了.</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//返回类型定义为String</span></div><div class="line"><span class="meta">@GET</span>(<span class="string">"top250"</span>)</div><div class="line"><span class="function">Call&lt;String&gt; <span class="title">testStringConverter</span><span class="params">(@Query(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div><div class="line"></div><div class="line"><span class="comment">//构建Retrofit时加上我们的StringConverterFactory</span></div><div class="line">.addConverterFactory(StringConverterFactory.create())<span class="comment">//两种Converter都支持的类型优先使用第一个</span></div></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="自定义CustomCallAdapter"><a href="#自定义CustomCallAdapter" class="headerlink" title="自定义CustomCallAdapter"></a>自定义CustomCallAdapter</h5><p><code>CallAdapter</code>的目的是将<code>Call&lt;?&gt;</code>转换为RxJava的<code>Observable&lt;?&gt;</code>、Guava的<code>ListenableFuture&lt;?&gt;</code>、自定义的<code>CustomCall&lt;?&gt;</code>，<br>这里就是体验下自定义CallAdapter，工作中用官方提供的就能满足需求。</p>
<ol>
<li><p><code>new Retrofit.Builder().addCallAdapterFactory(CallAdapter.Factory factory)</code>，该方法接收一个Factory，该工厂向Retrofit提供CallAdapter，<br>所以第一步写一个工厂类。具体写的时候多参考<code>RxJavaCallAdapterFactory</code>、<code>GuavaCallAdapterFactory</code>源码，有助于理解。</p>
<p> 抽象类<code>CallAdapter.Factory</code>中有一个抽象方法，两个工具方法。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*创建一个将Call&lt;?&gt;转换为自定义类型的CallAdapter，根据returnType判断是否能处理，不能处理时应返回null，此时的returnType为Call&lt;?&gt;类型*/</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> CallAdapter&lt;?&gt; get(Type returnType, Annotation[] annotations, Retrofit retrofit);</div><div class="line"></div><div class="line"><span class="comment">/*用于获取泛型的上边界参数，如Call&lt;?&gt;中的?、Call&lt;JsonObject&gt;中的JsonObject*/</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">static</span> Type <span class="title">getParameterUpperBound</span><span class="params">(<span class="keyword">int</span> index, ParameterizedType type)</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> Utils.getParameterUpperBound(index, type);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*用于获取泛型的原始类型，如Call&lt;?&gt;中的Call、Observable&lt;?&gt;中的Observable、CustomCall&lt;?&gt;中的CustomCall*/</span></div><div class="line"><span class="keyword">protected</span> <span class="keyword">static</span> Class&lt;?&gt; getRawType(Type type) &#123;</div><div class="line">  <span class="keyword">return</span> Utils.getRawType(type);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 所以可以写出工厂类。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomCallAdapterFactory</span> <span class="keyword">extends</span> <span class="title">CallAdapter</span>.<span class="title">Factory</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CustomCallAdapterFactory <span class="title">create</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CustomCallAdapterFactory();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*在本例中*/</span></div><div class="line">    <span class="comment">/*returnType为CustomCall&lt;R&gt;*/</span></div><div class="line">    <span class="comment">/*getRawType(returnType)为CustomCall.class*/</span></div><div class="line">    <span class="comment">/*responseType为R的具体类型*/</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> CallAdapter&lt;?&gt; get(Type returnType, Annotation[] annotations, Retrofit retrofit) &#123;</div><div class="line">        <span class="keyword">if</span> (getRawType(returnType) != CustomCall.class) &#123;<span class="comment">//检查返回的原始类型是否为CustomCall</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (!(returnType <span class="keyword">instanceof</span> ParameterizedType)) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</div><div class="line">                    <span class="string">"Call return type must be parameterized as Call&lt;Foo&gt; or Call&lt;? extends Foo&gt;"</span>);</div><div class="line">        &#125;</div><div class="line">        Type responseType = getParameterUpperBound(<span class="number">0</span>, (ParameterizedType) returnType);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CustomCallAdapter(responseType);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>public interface CallAdapter&lt;T&gt;</code>，该泛型接口中提供了两个接口。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*用于Converter的返回类型，如CustomCall&lt;String&gt;中的String*/</span></div><div class="line"><span class="function">Type <span class="title">responseType</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line"><span class="comment">/*将Call&lt;?&gt;类型转换为T类型，如CustomCall&lt;?&gt;*/</span></div><div class="line">&lt;R&gt; <span class="function">T <span class="title">adapt</span><span class="params">(Call&lt;R&gt; call)</span></span>;</div></pre></td></tr></table></figure>
<p> 所以可以写出具体的<code>CustomCallAdapter</code>类。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*自定义的Call适配器，作用为将返回的Call&lt;R&gt; 转化为 CustomCall&lt;R&gt;*/</span></div><div class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomCallAdapter</span> <span class="keyword">implements</span> <span class="title">CallAdapter</span>&lt;<span class="title">CustomCall</span>&lt;?&gt;&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Type responseType;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomCallAdapter</span><span class="params">(Type responseType)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.responseType = responseType;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Type <span class="title">responseType</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.responseType;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> &lt;R&gt; <span class="function">CustomCall&lt;R&gt; <span class="title">adapt</span><span class="params">(Call&lt;R&gt; call)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CustomCall(call);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>最后需要定义出<code>CustomCall&lt;R&gt;</code>，这里的<code>CustomCall</code>是对<code>Call</code>的一个简单包装，提供一个<code>getResult()</code>方法获取请求响应体。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomCall</span>&lt;<span class="title">R</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">private</span> Call&lt;R&gt; call;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomCall</span><span class="params">(Call&lt;R&gt; call)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.call = call;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 同步请求返回结果</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     * <span class="doctag">@throws</span> IOException</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">getResult</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.call.execute().body();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>大功告成，上手试试吧，<code>String</code>可以换成<code>JsonObject</code>等等。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*返回类型定义为CustomCall*/</span></div><div class="line"><span class="meta">@GET</span>(<span class="string">"top250"</span>)</div><div class="line">CustomCallAdapterFactory.<span class="function">CustomCall&lt;String&gt; <span class="title">testCustomCallAdapter</span><span class="params">(@Query(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div><div class="line"></div><div class="line"><span class="comment">//构建Retrofit时加上我们的StringConverterFactory</span></div><div class="line">.addCallAdapterFactory(CustomCallAdapterFactory.create())<span class="comment">//设置自定义请求适配器</span></div><div class="line"></div><div class="line"><span class="comment">//使用</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">customCallAdapter</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">final</span> CustomCallAdapterFactory.CustomCall&lt;String&gt; customCall = mMovieService.testCustomCallAdapter(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line"></div><div class="line">    <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                String result = customCall.getResult();</div><div class="line">                LogUtils.i(<span class="string">"CustomCallAdapter："</span> + result);</div><div class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">                LogUtils.e(e);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;).start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="放在后边"><a href="#放在后边" class="headerlink" title="放在后边"></a>放在后边</h3><p>关于Retrofit2.0的姿势就写到这里了，如有疑问和建议欢迎留言。</p>
</div><div class="tags"><a href="/tags/Retrofit2-0/">Retrofit2.0</a></div><div class="post-nav"><a href="/2017/02/08/okhttp+rxjava-experience/" class="pre">结合Retrofit2.0体验OkHttp+RxJava</a><a href="/2016/11/30/what-is-RESTful/" class="next">彻底理解什么是REST</a></div><div data-thread-key="2017/01/11/retrofit2-experience/" data-title="全面体验Retrofit2.0" data-url="http://51erwa.com/2017/01/11/retrofit2-experience/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2017/01/11/retrofit2-experience/" data-title="全面体验Retrofit2.0" data-url="http://51erwa.com/2017/01/11/retrofit2-experience/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="站内搜索" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">tech</a><span class="category-list-count">4</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/C语言/" style="font-size: 15px;">C语言</a> <a href="/tags/RESTful/" style="font-size: 15px;">RESTful</a> <a href="/tags/Retrofit2-0/" style="font-size: 15px;">Retrofit2.0</a> <a href="/tags/OkHttp/" style="font-size: 15px;">OkHttp</a> <a href="/tags/RxJava/" style="font-size: 15px;">RxJava</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/18/c-basics-record/">C语言基础知识补习①</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/08/okhttp+rxjava-experience/">结合Retrofit2.0体验OkHttp+RxJava</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/retrofit2-experience/">全面体验Retrofit2.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/30/what-is-RESTful/">彻底理解什么是REST</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-admin="1" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://wanzi.tv/" title="丸子影视" target="_blank">丸子影视</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">erwa'blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> Deployed in<a rel="nofollow" target="_blank" href="https://github.com/drawf"> GitHub.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'erwa'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>