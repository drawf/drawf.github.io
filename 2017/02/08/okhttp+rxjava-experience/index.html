<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="测试一下描述"><title>结合Retrofit2.0体验OkHttp+RxJava | erwa'blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">结合Retrofit2.0体验OkHttp+RxJava</h1><a id="logo" href="/.">erwa'blog</a><p class="description">非常高兴你能来到这里！</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">结合Retrofit2.0体验OkHttp+RxJava</h1><div class="post-meta">Feb 8, 2017<span> | </span><span class="category"><a href="/categories/tech/">tech</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2017/02/08/okhttp+rxjava-experience/" href="/2017/02/08/okhttp+rxjava-experience/#comments" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#放在前边"><span class="toc-number">1.</span> <span class="toc-text">放在前边</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OkHttp相关"><span class="toc-number">2.</span> <span class="toc-text">OkHttp相关</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Interceptors概述"><span class="toc-number">2.1.</span> <span class="toc-text">Interceptors概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义LoggingInterceptor"><span class="toc-number">2.2.</span> <span class="toc-text">自定义LoggingInterceptor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OkHttp缓存概述"><span class="toc-number">2.3.</span> <span class="toc-text">OkHttp缓存概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#一点HTTP缓存基础知识"><span class="toc-number">2.4.</span> <span class="toc-text">一点HTTP缓存基础知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#一点Android存储访问目录知识"><span class="toc-number">2.5.</span> <span class="toc-text">一点Android存储访问目录知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用OkHttp的缓存功能"><span class="toc-number">2.6.</span> <span class="toc-text">使用OkHttp的缓存功能</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RxJava相关"><span class="toc-number">3.</span> <span class="toc-text">RxJava相关</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Retrofit2-0-RxJava的基本使用"><span class="toc-number">3.1.</span> <span class="toc-text">Retrofit2.0+RxJava的基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RxJava的Schedulers"><span class="toc-number">3.2.</span> <span class="toc-text">RxJava的Schedulers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RxJava的Zip函数"><span class="toc-number">3.3.</span> <span class="toc-text">RxJava的Zip函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RxJava的Merge函数"><span class="toc-number">3.4.</span> <span class="toc-text">RxJava的Merge函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#放在后边"><span class="toc-number">4.</span> <span class="toc-text">放在后边</span></a></li></ol></div></div><div class="post-content"><h3 id="放在前边"><a href="#放在前边" class="headerlink" title="放在前边"></a>放在前边</h3><blockquote>
<p>注：本篇是结合Retrofit2.0来使用RxJava、OkHttp的一些姿势，关于RxJava的基础知识请先行补充。</p>
</blockquote>
<p><a href="https://github.com/drawf/demo.retrofit" target="_blank" rel="external">demo.retrofit传送门</a></p>
<p><img src="http://7sbl4z.com1.z0.glb.clouddn.com/demo.retrofit/blog/master/images/screenshot_2.png?imageMogr2/thumbnail/250x" alt=""></p>
<h3 id="OkHttp相关"><a href="#OkHttp相关" class="headerlink" title="OkHttp相关"></a>OkHttp相关</h3><h4 id="Interceptors概述"><a href="#Interceptors概述" class="headerlink" title="Interceptors概述"></a>Interceptors概述</h4><p>Interceptors are a powerful mechanism that can monitor, rewrite, and retry calls.</p>
<p>拦截器是一种强大的机制，可以监视、重写和重试请求.</p>
<p>拦截器分两种：</p>
<ol>
<li>Application Interceptors 应用拦截器，通过 OkHttpClient.Builder() 调用 addInterceptor() 方法来注册。</li>
<li>NetWork Interceptors 网络拦截器，通过 OkHttpClient.Builder() 调用 addNetWorkInterceptor() 方法来注册。</li>
</ol>
<p>通过一张图看一下二者的区别：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1504154-8daf5fd9540545d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt=""></p>
<p>应用拦截器只关注程序从发出请求到拿到结果，而不关心网络底层是从缓存取的结果还是从一次真正的网络请求拿到的结果。</p>
<p>网络拦截器只关注每一次真正的网络请求。</p>
<p>所以，当一次请求发生一次重定向时，应用拦截器执行一次，网络拦截器会执行两次；当一次请求读的缓存时，应用拦截器执行一次，网络拦截器并不会执行。</p>
<h4 id="自定义LoggingInterceptor"><a href="#自定义LoggingInterceptor" class="headerlink" title="自定义LoggingInterceptor"></a>自定义LoggingInterceptor</h4><p><a href="https://github.com/drawf/demo.retrofit/blob/master/app/src/main/java/tv/wanzi/demo/retrofit/interceptor/LoggingInterceptor.java" target="_blank" rel="external">LoggingInterceptor传送门</a></p>
<p>首先看<code>Interceptor</code>接口，覆写<code>intercept</code>方法，拦截的核心代码都在该方法中写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Interceptor</span> </span>&#123;</div><div class="line">    <span class="comment">/*需要覆写的拦截方法，具体操作都在该方法中进行*/</span></div><div class="line">    <span class="function">Response <span class="title">intercept</span><span class="params">(Chain chain)</span> <span class="keyword">throws</span> IOException</span>;</div><div class="line"></div><div class="line">    <span class="comment">/*通过Chain实例，可以得到Request实例，并可以通过proceed方法得到Response实例*/</span></div><div class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Chain</span> </span>&#123;</div><div class="line">        <span class="function">Request <span class="title">request</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">        <span class="comment">/*该方法每次调用都是进行一次网络请求（可能是取的缓存可能是真实网络请求），所以调用一次即可，切勿盲目多次调用*/</span></div><div class="line">        <span class="function">Response <span class="title">proceed</span><span class="params">(Request request)</span> <span class="keyword">throws</span> IOException</span>;</div><div class="line"></div><div class="line">        <span class="function">Connection <span class="title">connection</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再看一下<code>LoggingInterceptor</code>的核心代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> Response <span class="title">intercept</span><span class="params">(Chain chain)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">    <span class="comment">/*得到原来的Request实例后就可以 重写请求*/</span></div><div class="line">    Request originRequest = chain.request();</div><div class="line"></div><div class="line">    <span class="keyword">long</span> t1 = System.nanoTime();</div><div class="line">    <span class="comment">/*得到原来的Response实例后就可以 重写响应*/</span></div><div class="line">    Response originResponse = chain.proceed(originRequest);</div><div class="line">    <span class="keyword">long</span> t2 = System.nanoTime();</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (BuildConfig.DEBUG &amp;&amp; eLog != LOG.NONE) &#123;</div><div class="line">        <span class="keyword">double</span> time = (t2 - t1) / <span class="number">1e6</span>d;</div><div class="line"></div><div class="line">        <span class="comment">//url ⇢ http://xxx</span></div><div class="line">        <span class="keyword">if</span> (eLog == LOG.DEFAULT) &#123;</div><div class="line">            String format = <span class="string">"method%s%s\nurl%s%s\nbody%s%s\ntime%s%s\n"</span> +</div><div class="line">                    <span class="string">"response code%s%s\nresponse body%s%s\n"</span>;</div><div class="line"></div><div class="line">            String message = String.format(format,</div><div class="line">                    SEPARATOR, originRequest.method(),</div><div class="line">                    SEPARATOR, originRequest.url(),</div><div class="line">                    SEPARATOR, requestBody2String(originRequest.body()),</div><div class="line">                    SEPARATOR, time,</div><div class="line">                    SEPARATOR, originResponse.code(),</div><div class="line">                   <span class="comment">/*这里需要注意的是originResponse.body()一旦消费掉后，响应体就会为空，解决方法见responseBody2String源码*/</span></div><div class="line">                    SEPARATOR, responseBody2String(originResponse.body()));</div><div class="line">            LogUtils.v(message);</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (eLog == LOG.ALL) &#123;</div><div class="line">            String format = <span class="string">"method%s%s\nurl%s%s\nheaders%s%s\nbody%s%s\ntime%s%s\n"</span> +</div><div class="line">                    <span class="string">"response code%s%s\nresponse headers%s%s\nresponse body%s%s\n"</span>;</div><div class="line"></div><div class="line">            String message = String.format(format,</div><div class="line">                    SEPARATOR, originRequest.method(),</div><div class="line">                    SEPARATOR, originRequest.url(),</div><div class="line">                    SEPARATOR, originRequest.headers(),</div><div class="line">                    SEPARATOR, requestBody2String(originRequest.body()),</div><div class="line">                    SEPARATOR, time,</div><div class="line">                    SEPARATOR, originResponse.code(),</div><div class="line">                    SEPARATOR, originResponse.headers(),</div><div class="line">                    SEPARATOR, responseBody2String(originResponse.body()));</div><div class="line">            LogUtils.v(message);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> originResponse;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">responseBody2String</span><span class="params">(ResponseBody responseBody)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">    <span class="keyword">if</span> (responseBody == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="string">"this request has no response body."</span>;</div><div class="line"></div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line"></div><div class="line">    BufferedSource source = responseBody.source();</div><div class="line">    source.request(Long.MAX_VALUE); <span class="comment">// Buffer the entire body.</span></div><div class="line">    Buffer buffer = source.buffer().clone();<span class="comment">//clone出响应体内容，这样就不会消费掉了</span></div><div class="line"></div><div class="line">    Charset charset = Charset.forName(<span class="string">"UTF-8"</span>);</div><div class="line">    MediaType contentType = responseBody.contentType();</div><div class="line">    <span class="keyword">if</span> (contentType != <span class="keyword">null</span>) &#123;</div><div class="line">        charset = contentType.charset(charset);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (isPlaintext(buffer)) &#123;</div><div class="line">        sb.append(buffer.readString(charset));</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        sb.append(responseBody.contentLength()).append(<span class="string">"-byte binary body omitted)"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sb.toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="OkHttp缓存概述"><a href="#OkHttp缓存概述" class="headerlink" title="OkHttp缓存概述"></a>OkHttp缓存概述</h4><p>OkHttp是由Square发布的一个HTTP client，它支持高速缓存服务器响应的语义，即Header中的<code>Cache-control</code>，<code>only-if-cached</code>等标签。</p>
<p>OkHttp的缓存设计和浏览器的一样，缓存是自动完成的，完全由服务器的Header决定，是用来提升用户体验降低服务器负荷的。</p>
<h4 id="一点HTTP缓存基础知识"><a href="#一点HTTP缓存基础知识" class="headerlink" title="一点HTTP缓存基础知识"></a>一点HTTP缓存基础知识</h4><blockquote>
<p>注：图中的 ETag 和 Last-Modified 没有优先级。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/98641-4bd320d4e34af60a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt=""></p>
<ol>
<li><p><strong>Expires</strong></p>
<p> HTTP1.0使用的过期策略，它使用时间戳来标识缓存是否过期。这个方式缺陷很明显，客户端和服务端的时间不同步时，导致过期判断经常不准确。现在HTTP请求基本都使用HTTP1.1以上了，这个字段基本没用了。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Expires: Thu, <span class="number">12</span> Jan <span class="number">2017</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">33</span> GMT</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Cache-Control</strong></p>
<p> Cache-Control与Expires的作用一致，区别在于前者使用过期时间长度来标识是否过期，例如前者使用过期为30天，后者使用过期时间为2017年2月30日。因此使用Cache-Control能够较为准确的判断缓存是否过期，现在基本上都是使用这个参数。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*表示此次请求结果过期时长为60s*/</span></div><div class="line">Cache-control: max-age=<span class="number">60</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>条件GET请求(Conditional GET Requests)与304</strong></p>
<p> 如果缓存过期或者强制放弃缓存，在此情况下，缓存策略全部交给服务器判断，客户端只发送条件get请求即可，如果缓存是有效的，则返回304 Not Modified，否则直接返回body。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">第一种方式：Last-Modified-Date</div><div class="line"></div><div class="line"><span class="comment">/*客户端第一次请求时服务器返回如下*/</span></div><div class="line">Last-Modified: Tue, <span class="number">12</span> Jan <span class="number">2016</span> <span class="number">09</span>:<span class="number">31</span>:<span class="number">27</span> GMT</div><div class="line"></div><div class="line"><span class="comment">/*客户端再次请求时，通过发送如下，交给服务器进行判断，如果缓存可用便返回304*/</span></div><div class="line">If-Modified-Since: Tue, <span class="number">12</span> Jan <span class="number">2016</span> <span class="number">09</span>:<span class="number">31</span>:<span class="number">27</span> GMT</div><div class="line"></div><div class="line">第二种方式：ETag，ETag是对资源文件的一种摘要，客户端并不需要了解实现细节。</div><div class="line"></div><div class="line"><span class="comment">/*当客户端第一请求时，服务器返回如下*/</span></div><div class="line">ETag: <span class="string">"5694c7ef-24dc"</span></div><div class="line"></div><div class="line"><span class="comment">/*客户端再次请求时，通过发送如下，交给服务器进行判断，如果缓存可用便返回304*/</span></div><div class="line">If-None-Match:<span class="string">"5694c7ef-24dc"</span></div></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="一点Android存储访问目录知识"><a href="#一点Android存储访问目录知识" class="headerlink" title="一点Android存储访问目录知识"></a>一点Android存储访问目录知识</h4><ol>
<li><p><strong>应用数据目录（$appDataDir）</strong></p>
<p> 内部存储：$appDataDir = $rootDir/data/$packageName</p>
<p> 外部存储：$appDataDir = $rootDir/Android/data/$packageName</p>
<p> app卸载之后，这两个目录下的数据会被系统删除，我们应将应用的数据放在这两个目录下。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*使用 外部存储 需要的权限，从API 19/Andorid 4.4/KITKAT开始，不再需要显式声明这两个权限，除非要读写其他应用的应用数据($appDataDir)*/</span></div><div class="line">&lt;uses-permission android:name=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span> /&gt;</div><div class="line">&lt;uses-permission android:name=<span class="string">"android.permission.READ_EXTERNAL_STORAGE"</span> /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>应用数据目录下的-<em>缓存目录</em></strong></p>
<p> 内部存储：Context.getCacheDir()，机身内存不足时，文件就会被删除。</p>
<p> 外部存储：Context.getExternalCacheDir()，外部存储没有实时监控，空间不足时，文件不会被实时删除，可能返回空对象。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Context.getCacheDir()</div><div class="line">/data/data/tv.wanzi.demo.retrofit/cache</div><div class="line"></div><div class="line">Context.getExternalCacheDir():</div><div class="line">/storage/sdcard0/Android/data/tv.wanzi.demo.retrofit/cache</div></pre></td></tr></table></figure>
</li>
<li><p><strong>应用数据目录下的-<em>文件目录</em></strong></p>
<p> 内部存储：Context.getFilesDir()，Context.getFileStreamPath(String name) 返回以 name 为文件名的文件对象，name 为空时返回 $filesDir 本身。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Context.getFilesDir()</div><div class="line">/data/data/tv.wanzi.demo.retrofit/files</div><div class="line"></div><div class="line">Context.getFileStreamPath(<span class="string">""</span>)</div><div class="line">/data/data/tv.wanzi.demo.retrofit/files</div><div class="line"></div><div class="line">Context.getFileStreamPath(<span class="string">"file1"</span>):</div><div class="line">/data/data/tv.wanzi.demo.retrofit/files/file1</div></pre></td></tr></table></figure>
<p> 外部存储：Context.getExternalFilesDir(String type)，type 为空时返回 $filesDir 本身。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*type 系统指定了几种*/</span></div><div class="line">Environment.DIRECTORY_MUSIC</div><div class="line">Environment.DIRECTORY_PICTURES</div><div class="line">Environment.DIRECTORY_MOVIES</div><div class="line">Environment.DIRECTORY_DOWNLOADS</div><div class="line">...</div><div class="line"></div><div class="line">Context.getExternalFilesDir()</div><div class="line">/storage/sdcard0/Android/data/tv.wanzi.demo.retrofit/files</div><div class="line"></div><div class="line">Context.getExternalFilesDir(Environment.DIRECTORY_MUSIC)</div><div class="line">/storage/sdcard0/Android/data/tv.wanzi.demo.retrofit/files/Music</div><div class="line"></div><div class="line">Context.getExternalFilesDir(<span class="string">"responses"</span>)</div><div class="line">/storage/sdcard0/Android/data/tv.wanzi.demo.retrofit/files/responses</div></pre></td></tr></table></figure>
</li>
<li><p><strong>$cacheDir/$filesDir的安全性</strong></p>
<p> 内部存储：$cacheDir，$filesDir是app安全的，其他应用无法读取本应用的数据。</p>
<p> 外部存储：这两个文件夹其他应用程序也可访问，$filesDir中的媒体文件，不会被当做媒体扫描出来，加到媒体库中。</p>
</li>
</ol>
<h4 id="使用OkHttp的缓存功能"><a href="#使用OkHttp的缓存功能" class="headerlink" title="使用OkHttp的缓存功能"></a>使用OkHttp的缓存功能</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">OkHttpClient client = <span class="keyword">new</span> OkHttpClient.Builder()</div><div class="line"><span class="comment">/*配置好缓存即可使用缓存功能*/</span></div><div class="line">.cache(FileUtils.getOkHttpCache())</div><div class="line">.build();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Cache <span class="title">getOkHttpCache</span><span class="params">()</span> </span>&#123;</div><div class="line">    File responses = getEFDDir(<span class="string">"responses"</span>);</div><div class="line">    <span class="keyword">if</span> (responses == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    <span class="comment">/*配置缓存目录及缓存大小*/</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Cache(responses, HTTP_RESPONSE_DISK_CACHE_MAX_SIZE);<span class="comment">//10 * 1024 * 1024=10M</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*获取外部存储目录*/</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> File <span class="title">getEFDDir</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (!hasSDCardMounted()) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    Context context = MainApplication.getContext();</div><div class="line">    <span class="keyword">return</span> context.getExternalFilesDir(name);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="RxJava相关"><a href="#RxJava相关" class="headerlink" title="RxJava相关"></a>RxJava相关</h3><h4 id="Retrofit2-0-RxJava的基本使用"><a href="#Retrofit2-0-RxJava的基本使用" class="headerlink" title="Retrofit2.0+RxJava的基本使用"></a>Retrofit2.0+RxJava的基本使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*gradle 加上这两个依赖*/</span></div><div class="line">compile <span class="string">'com.squareup.retrofit2:adapter-rxjava:2.1.0'</span></div><div class="line">compile <span class="string">'io.reactivex:rxandroid:1.2.1'</span></div><div class="line"></div><div class="line"><span class="comment">/*构建Retrofit时加上RxJavaCallAdapterFactory*/</span></div><div class="line"><span class="keyword">new</span> Retrofit.Builder().addCallAdapterFactory(RxJavaCallAdapterFactory.create())</div><div class="line"></div><div class="line"><span class="comment">/*定义API时候就可以返回Observable类型了*/</span></div><div class="line"><span class="meta">@GET</span>(<span class="string">"top250"</span>)</div><div class="line"><span class="function">Observable&lt;JsonObject&gt; <span class="title">testRxJava</span><span class="params">(@Query(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div><div class="line"></div><div class="line"><span class="comment">/*一次基本的请求过程*/</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testRxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable&lt;JsonObject&gt; observable = mMovieService.testRxJava(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line">    observable</div><div class="line">            <span class="comment">//指定subscribe()所发生的线程，即Observable.OnSubscribe被激活时所处的线程，或者叫事件产生的线程。</span></div><div class="line">            .subscribeOn(Schedulers.io())</div><div class="line">            <span class="comment">//指定Subscriber所运行在的线程，或者叫事件消费的线程。</span></div><div class="line">            .observeOn(AndroidSchedulers.mainThread())</div><div class="line">            .subscribe(<span class="keyword">new</span> Subscriber&lt;JsonObject&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;<span class="comment">//事件还未发送之前被调用，做一些准备工作</span></div><div class="line">                    <span class="keyword">super</span>.onStart();</div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava:RxJava Request onStart"</span>);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;<span class="comment">//事件队列完结</span></div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava:RxJava Request onCompleted"</span>);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;<span class="comment">//事件队列异常</span></div><div class="line">                    LogUtils.e(e);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(JsonObject jsonObject)</span> </span>&#123;<span class="comment">//处理返回数据</span></div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava:"</span> + jsonObject.toString());</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="RxJava的Schedulers"><a href="#RxJava的Schedulers" class="headerlink" title="RxJava的Schedulers"></a>RxJava的Schedulers</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*在main线程中测试一下*/</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testRxJavaScheduler</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable&lt;JsonObject&gt; observable = mMovieService.testRxJava(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line">    observable</div><div class="line">            <span class="comment">/*同Subscriber.onStart()一样是在 subscribe() 调用后而且在事件发送前执行，区别在于它可以指定线程*/</span></div><div class="line">            <span class="comment">/*默认情况下，doOnSubscribe() 执行在 subscribe() 发生的线程；而如果在 doOnSubscribe() 之后有 subscribeOn() 的话，它将执行在离它最近的 subscribeOn() 所指定的线程。*/</span></div><div class="line">            .doOnSubscribe(<span class="keyword">new</span> Action0() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava Scheduler: doOnSubscribe thread name -&gt; "</span> + Thread.currentThread().getName());</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">            .subscribeOn(Schedulers.io())<span class="comment">//指定subscribe()所发生的线程，即Observable.OnSubscribe被激活时所处的线程，或者叫事件产生的线程。</span></div><div class="line">            .observeOn(AndroidSchedulers.mainThread())<span class="comment">//指定Subscriber所运行在的线程，或者叫事件消费的线程。</span></div><div class="line">            .subscribe(<span class="keyword">new</span> Subscriber&lt;JsonObject&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;<span class="comment">//这里onStart()总是在执行subscribe()方法的线程中执行，不能单独指定线程</span></div><div class="line">                    <span class="keyword">super</span>.onStart();</div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava Scheduler: onStart thread name -&gt; "</span> + Thread.currentThread().getName());</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava Scheduler: onCompleted thread name -&gt; "</span> + Thread.currentThread().getName());</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</div><div class="line">                    LogUtils.e(e);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(JsonObject jsonObject)</span> </span>&#123;</div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava Scheduler:"</span> + jsonObject.toString());</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*在新线程中测试一下*/</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testRxJavaSchedulerInNewThread</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">new</span> Thread() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>.run();</div><div class="line">            LogUtils.i(<span class="string">"Test RxJava Scheduler: request thread name -&gt; "</span> + Thread.currentThread().getName());</div><div class="line">            <span class="comment">//将请求代码发到这里，onStart 执行所在线程就不是主线程了，因为onStart()总是在执行subscribe()方法的线程中执行，不能单独指定线程</span></div><div class="line">            testRxJavaScheduler();</div><div class="line">        &#125;</div><div class="line">    &#125;.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="RxJava的Zip函数"><a href="#RxJava的Zip函数" class="headerlink" title="RxJava的Zip函数"></a>RxJava的Zip函数</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*新增一条返回JsonArray的API，以示区别*/</span></div><div class="line"><span class="meta">@GET</span></div><div class="line"><span class="function">Observable&lt;JsonArray&gt; <span class="title">testRxJava1</span><span class="params">(@Url String url, @Query(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Query</span><span class="params">(<span class="string">"count"</span>)</span> <span class="keyword">int</span> count)</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testRxJavaZip</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable&lt;JsonObject&gt; observable = mMovieService.testRxJava(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line">    Observable&lt;JsonArray&gt; observable1 = mMovieService.testRxJava1(<span class="string">"https://movie.douban.com/j/cinemas/?city_id=108288&amp;limit=5"</span>, <span class="number">0</span>, <span class="number">2</span>);</div><div class="line"></div><div class="line">    <span class="comment">//zip方法把多个Observable组合成新的Observable，新的Observable对应的数据由call方法决定，它可以对数据源做二次操作</span></div><div class="line">    <span class="comment">//zip还有接受更多参数的重载方法</span></div><div class="line">    Observable.zip(observable, observable1, <span class="keyword">new</span> Func2&lt;JsonObject, JsonArray, JsonArray&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> JsonArray <span class="title">call</span><span class="params">(JsonObject jsonObject, JsonArray jsonElements)</span> </span>&#123;</div><div class="line">            JsonArray array = <span class="keyword">new</span> JsonArray();</div><div class="line">            array.add(jsonObject);</div><div class="line">            array.add(<span class="string">"================="</span>);</div><div class="line">            array.add(jsonElements);</div><div class="line">            <span class="keyword">return</span> array;</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">            .subscribeOn(Schedulers.io())</div><div class="line">            .observeOn(AndroidSchedulers.mainThread())</div><div class="line">            .subscribe(<span class="keyword">new</span> Action1&lt;JsonArray&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(JsonArray jsonElements)</span> </span>&#123;</div><div class="line">                    LogUtils.i(<span class="string">"Test RxJava zip:"</span> + jsonElements.toString());</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="RxJava的Merge函数"><a href="#RxJava的Merge函数" class="headerlink" title="RxJava的Merge函数"></a>RxJava的Merge函数</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testRxJavaMerge</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable&lt;JsonObject&gt; observable = mMovieService.testRxJava(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line">    Observable&lt;JsonArray&gt; observable1 = mMovieService.testRxJava1(<span class="string">"https://movie.douban.com/j/cinemas/?city_id=108288&amp;limit=5"</span>, <span class="number">0</span>, <span class="number">2</span>);</div><div class="line"></div><div class="line">    <span class="comment">//merge方法可以合并多个数据源，但数据会被依次发射出来</span></div><div class="line">    Observable.merge(observable, observable1)</div><div class="line">            .subscribeOn(Schedulers.io())</div><div class="line">            .observeOn(AndroidSchedulers.mainThread())</div><div class="line">            .subscribe(<span class="keyword">new</span> Action1&lt;Object&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Object object)</span> </span>&#123;</div><div class="line">                    <span class="keyword">if</span> (object <span class="keyword">instanceof</span> JsonObject) &#123;</div><div class="line">                        LogUtils.i(<span class="string">"Test RxJava Merge:observable result -&gt; "</span> + object.toString());</div><div class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (object <span class="keyword">instanceof</span> JsonArray) &#123;</div><div class="line">                        LogUtils.i(<span class="string">"Test RxJava Merge:observable1 result -&gt; "</span> + object.toString());</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        LogUtils.e(<span class="keyword">new</span> RuntimeException(<span class="string">"数据异常"</span>));</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="放在后边"><a href="#放在后边" class="headerlink" title="放在后边"></a>放在后边</h3><p>如有疑问和建议欢迎留言。</p>
</div><div class="tags"><a href="/tags/Retrofit2-0/">Retrofit2.0</a><a href="/tags/OkHttp/">OkHttp</a><a href="/tags/RxJava/">RxJava</a></div><div class="post-nav"><a href="/2017/02/18/c-basics-record/" class="pre">C语言基础知识补习①</a><a href="/2017/01/11/retrofit2-experience/" class="next">全面体验Retrofit2.0</a></div><div data-thread-key="2017/02/08/okhttp+rxjava-experience/" data-title="结合Retrofit2.0体验OkHttp+RxJava" data-url="http://51erwa.com/2017/02/08/okhttp+rxjava-experience/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2017/02/08/okhttp+rxjava-experience/" data-title="结合Retrofit2.0体验OkHttp+RxJava" data-url="http://51erwa.com/2017/02/08/okhttp+rxjava-experience/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="站内搜索" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">tech</a><span class="category-list-count">4</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/C语言/" style="font-size: 15px;">C语言</a> <a href="/tags/Retrofit2-0/" style="font-size: 15px;">Retrofit2.0</a> <a href="/tags/OkHttp/" style="font-size: 15px;">OkHttp</a> <a href="/tags/RxJava/" style="font-size: 15px;">RxJava</a> <a href="/tags/RESTful/" style="font-size: 15px;">RESTful</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/18/c-basics-record/">C语言基础知识补习①</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/08/okhttp+rxjava-experience/">结合Retrofit2.0体验OkHttp+RxJava</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/retrofit2-experience/">全面体验Retrofit2.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/30/what-is-RESTful/">彻底理解什么是REST</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-admin="1" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://wanzi.tv/" title="丸子影视" target="_blank">丸子影视</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">erwa'blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> Deployed in<a rel="nofollow" target="_blank" href="https://github.com/drawf"> GitHub.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'erwa'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>